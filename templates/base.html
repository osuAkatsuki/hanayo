{{ define "base" }}
{{ $cf := .ClientFlags }}
{{ $ds := band $cf 1 }}
{{ $   := . }}
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>{{ if .TitleBar }}{{ .T .TitleBar }} - {{ end }}Akatsuki</title>

		<link rel="stylesheet" type="text/css" href="/static/css/semantic.min.css?{{ unixNano }}">
		<link rel="stylesheet" type="text/css" href="/static/css/akatsuki.css?{{ unixNano }}">

		<script src="https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@latest/pace-theme-default.min.css">
		
		<style>
			body{
				--base: 213;
			}
		</style>
	</head>
	<body>
		<div class="ui full height main wrapper" id="app"
			{{ if and .DisableHH .KyutGrill }}
				style="background-image: url('{{ if .KyutGrillAbsolute }}{{ .KyutGrill }}{{ else }}/static/headers/{{ .KyutGrill }}{{ end }}');"
			{{ else if .SolidColour }}
				style="background-color: {{ .SolidColour }}"
			{{ end }}>
			{{ template "navbar" . }}

			<div id="messages-container">
				<noscript>Research has proven this website works 10000% better if you have JavaScript enabled.</noscript>
				{{ if and .Context.User.Username (not (has .Context.User.Privileges 1)) }}
					<div class="ui warning message">
						{{ $.T "Your account is currently in restricted mode, and will not be able to perform certain actions. Your profile has been hidden from normal users. If you believe this was a mistake (or have waited more than 2 months since your latest offense), you may appeal using <a href='https://goo.gl/forms/qDBIMgcvpFLWCNwf2'>this form</a>." | html }}
					</div>
				{{ end }}
				{{ if .Messages }}
						{{ range $i, $v := .Messages }}
							<div class="ui {{ $v.Type }} message">
								<i class="close icon"></i>
								{{ html $v.Content }}
							</div>
						{{ end }}
				{{ end }}
				{{ $settings := systemSettings "website_maintenance" "game_maintenance" "website_global_alert" }}
				{{ with $settings.website_global_alert.String }}
					<div class="ui info message">
						{{ . | html }}
					</div>
				{{ end }}
				{{ with $settings.game_maintenance.Int }}
					<div class="ui warning message">
						{{ $.T "Akatsuki's score submission is currently in maintenance mode. You will not be allowed to submit scores for the time being." }}
					</div>
				{{ end }}
				{{ with $settings.website_maintenance.Int }}
					<div class="ui warning message">
						{{ $.T "The Akatsuki website is currently in maintenance mode, and access has been limited for normal users." }}
					</div>
				{{ end }}
				</div>
			
			{{ if not .DisableHH }}
				<div class="huge heading {{ if .HeadingOnRight }}right{{ end }} dropped"
					style="background:linear-gradient( rgb(0 0 0 / 35%), rgb(0 0 0 / 35%) ), url(
						{{ if .KyutGrillAbsolute }}{{ .KyutGrill }}{{ else }}/static/headers/{{ or .KyutGrill "default.jpg" }}{{ end }})">
					<div class="ui container">
						<h1>{{ if .HeadingTitle }}{{ .T .HeadingTitle | html }}{{ else }}{{ .T .TitleBar }}{{ end }}</h1>
					</div>
				</div>
			{{ end }}

			<div class="h-container">
				{{ template "tpl" . }}
			</div>

		</div>
		<center class="footer">
			<div class="ui container center">
			{{ .T "&copy; %d osu!Akatsuki, using Hanayo %s." (curryear) (version) | html }}
				<a href="/team" title="{{ .T "Who is working on this thing?" }}"><i class="users icon"></i>{{ .T "Team" }}</a>
				<a href="https://github.com/osuakatsuki" title="{{ .T "Git"}}{{/*'"*/}}"><i class="git square icon"></i></a>
				<div class="ui scrolling dropdown" style="margin-left: 5px;" id="language-selector">
				{{ $lang := .Context.Language }}
				{{ with $lang }}
				{{ $info := languageInformationByNameShort . }}
					<div class="text"><i class="{{ $info.CountryShort }} flag"></i>{{ $info.Name }}</div>
				{{ else }}
					<div class="default text">{{ .T "Language" }}</div>
				{{ end }}
					<i class="dropdown icon"></i>
					<div class="menu">
					{{ range languageInformation }}
						<div class="{{ if eq .NameShort $lang }}selected {{ end }}item" data-lang="{{ .NameShort }}"><i
								class="{{ .CountryShort }} flag"></i>{{ .Name }}</div>
					{{ end }}
					</div>
				</div>
			</div>
		</center>
		
		<script>
			var hanayoConf = {
				avatars:   '{{ .Conf.AvatarURL }}',
				banchoAPI: '{{ .Conf.BanchoAPI }}',
				baseAPI:   '{{ .Conf.BaseAPIPublic }}',
				cheesegullAPI: '{{ .Conf.CheesegullAPI }}',
			};
			var currentUserID = '{{ .Context.User.ID }}';
		</script>
		<script>
			$(".language-select").on('click', function(event){
			    event.stopPropagation();
			    event.stopImmediatePropagation();
				var lang = $(this).data("lang");
				document.cookie = "language=" + lang + ";path=/;max-age=31536000";
				window.location.reload()
			});
		</script>

		<script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
		<script src="/static/js/dist.min.js?{{ unixNano }}"></script>
		{{ if .Scripts }}
			{{ range .Scripts }}
				<script src="{{ . }}?{{ unixNano }}"></script>
			{{ end }}
		{{ end }}
	</body>
</html>
{{ end }}
